# Design: Kimchi-Agent â€” ê¹€ì¹˜ê³µì¥ ì „ìš© AI Agent

**Feature ID**: kimchi-agent
**Created**: 2026-02-27
**Phase**: MVP (Phase 1)
**Status**: Design

---

## 1. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        í´ë¼ì´ì–¸íŠ¸ (Browser)                          â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ChatWindowâ”‚  â”‚ QuickQuestionsâ”‚ â”‚ VoiceInput â”‚  â”‚ DocumentUploadâ”‚  â”‚
â”‚  â”‚          â”‚  â”‚             â”‚  â”‚ (STT)      â”‚  â”‚              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚       â”‚               â”‚               â”‚                â”‚          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Sidebar (ëŒ€í™” ëª©ë¡)                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ HTTP / SSE (Server-Sent Events)
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Next.js 14 App Router (ì„œë²„)                     â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ POST /api/chat   â”‚  â”‚ POST /api/      â”‚  â”‚ GET /api/           â”‚ â”‚
â”‚  â”‚ (Claude Stream)  â”‚  â”‚ documents/uploadâ”‚  â”‚ conversations       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚          â”‚                     â”‚                      â”‚            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                     RAG Pipeline                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ Chunker  â”‚  â”‚ Embedder â”‚  â”‚ Retriever â”‚  â”‚ Context      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ (ë¬¸ì„œë¶„í• ) â”‚  â”‚ (ì„ë² ë”©)  â”‚  â”‚ (ìœ ì‚¬ê²€ìƒ‰) â”‚  â”‚ Injector     â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                   â”‚                      â”‚
         â–¼                   â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Claude API  â”‚   â”‚  Vector DB   â”‚       â”‚  bkend.ai        â”‚
â”‚  (Anthropic) â”‚   â”‚  (Chroma /   â”‚       â”‚  (ëŒ€í™”/ë¬¸ì„œ ë©”íƒ€)  â”‚
â”‚  Streaming   â”‚   â”‚   pgvector)  â”‚       â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë°ì´í„° íë¦„ ìš”ì•½

1. **ì±„íŒ… íë¦„**: ì‚¬ìš©ì ì…ë ¥ â†’ `/api/chat` â†’ RAG ì»¨í…ìŠ¤íŠ¸ ì£¼ì… â†’ Claude API (ìŠ¤íŠ¸ë¦¬ë°) â†’ SSEë¡œ ì‘ë‹µ
2. **ë¬¸ì„œ ì—…ë¡œë“œ íë¦„**: íŒŒì¼ ì„ íƒ â†’ `/api/documents/upload` â†’ ì²­í‚¹ â†’ ì„ë² ë”© â†’ Vector DB ì €ì¥
3. **íˆìŠ¤í† ë¦¬ íë¦„**: ëŒ€í™” ì €ì¥/ì¡°íšŒ â†” bkend.ai REST API

---

## 2. í”„ë¡œì íŠ¸ êµ¬ì¡°

```
kimchi-agent/
â”œâ”€â”€ app/                          # Next.js 14 App Router
â”‚   â”œâ”€â”€ layout.tsx                # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ
â”‚   â”œâ”€â”€ page.tsx                  # ë©”ì¸ ì±„íŒ… í˜ì´ì§€
â”‚   â”œâ”€â”€ globals.css               # ì „ì—­ ìŠ¤íƒ€ì¼ (Tailwind)
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”‚   â””â”€â”€ route.ts          # POST - Claude ìŠ¤íŠ¸ë¦¬ë° ì±„íŒ…
â”‚   â”‚   â”œâ”€â”€ documents/
â”‚   â”‚   â”‚   â””â”€â”€ upload/
â”‚   â”‚   â”‚       â””â”€â”€ route.ts      # POST - ë¬¸ì„œ ì—…ë¡œë“œ + RAG ì²˜ë¦¬
â”‚   â”‚   â””â”€â”€ conversations/
â”‚   â”‚       â”œâ”€â”€ route.ts          # GET - ëŒ€í™” ëª©ë¡ ì¡°íšŒ, POST - ì‹ ê·œ ëŒ€í™” ìƒì„±
â”‚   â”‚       â””â”€â”€ [id]/
â”‚   â”‚           â””â”€â”€ route.ts      # GET - ëŒ€í™” ìƒì„¸, DELETE - ëŒ€í™” ì‚­ì œ
â”‚   â””â”€â”€ conversations/
â”‚       â””â”€â”€ [id]/
â”‚           â””â”€â”€ page.tsx          # íŠ¹ì • ëŒ€í™” í˜ì´ì§€
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”œâ”€â”€ ChatWindow.tsx        # ë©”ì¸ ì±„íŒ… ì°½ (ë©”ì‹œì§€ ëª©ë¡ + ì…ë ¥)
â”‚   â”‚   â”œâ”€â”€ MessageBubble.tsx     # ê°œë³„ ë©”ì‹œì§€ ë²„ë¸” (user/assistant)
â”‚   â”‚   â”œâ”€â”€ ChatInput.tsx         # í…ìŠ¤íŠ¸ ì…ë ¥ + ì „ì†¡ ë²„íŠ¼
â”‚   â”‚   â”œâ”€â”€ VoiceInput.tsx        # ìŒì„± ì…ë ¥ ë²„íŠ¼ (STT)
â”‚   â”‚   â””â”€â”€ QuickQuestions.tsx    # Predefined ì§ˆë¬¸ ì¹´ë“œ
â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx           # ëŒ€í™” ëª©ë¡ ì‚¬ì´ë“œë°”
â”‚   â”‚   â”œâ”€â”€ Header.tsx            # ìƒë‹¨ í—¤ë”
â”‚   â”‚   â”œâ”€â”€ MobileNav.tsx         # ëª¨ë°”ì¼ ë„¤ë¹„ê²Œì´ì…˜ â€» Sidebar ì˜¤ë²„ë ˆì´ + BottomNavë¡œ ëŒ€ì²´ êµ¬í˜„
â”‚   â”‚   â””â”€â”€ BottomNav.tsx         # ëª¨ë°”ì¼ í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ (ì±„íŒ…/ëŒ€í™”ëª©ë¡/ë¬¸ì„œ 3íƒ­)
â”‚   â””â”€â”€ documents/
â”‚       â””â”€â”€ DocumentUpload.tsx    # ë¬¸ì„œ ì—…ë¡œë“œ ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ ai/
â”‚   â”‚   â”œâ”€â”€ claude.ts             # Claude API í´ë¼ì´ì–¸íŠ¸ ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ streaming.ts          # ìŠ¤íŠ¸ë¦¬ë° ìœ í‹¸ë¦¬í‹°
â”‚   â”‚   â””â”€â”€ system-prompt.ts      # ê¹€ì¹˜ê³µì¥ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸
â”‚   â”œâ”€â”€ rag/
â”‚   â”‚   â”œâ”€â”€ chunker.ts            # ë¬¸ì„œ ì²­í‚¹ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ embedder.ts           # ì„ë² ë”© ìƒì„±
â”‚   â”‚   â”œâ”€â”€ retriever.ts          # ë²¡í„° ìœ ì‚¬ë„ ê²€ìƒ‰
â”‚   â”‚   â””â”€â”€ pipeline.ts           # RAG íŒŒì´í”„ë¼ì¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â””â”€â”€ bkend.ts              # bkend.ai í´ë¼ì´ì–¸íŠ¸
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ markdown.ts           # ë§ˆí¬ë‹¤ìš´ ë Œë”ë§ ìœ í‹¸
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useChat.ts                # ì±„íŒ… ìƒíƒœ ê´€ë¦¬ í›…
â”‚   â”œâ”€â”€ useVoice.ts               # ìŒì„± ì…ë ¥ í›… â€» VoiceInput ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì— ì§ì ‘ êµ¬í˜„
â”‚   â””â”€â”€ useConversations.ts       # ëŒ€í™” ëª©ë¡ í›…
â”œâ”€â”€ types/
â”‚   â””â”€â”€ index.ts                  # ê³µí†µ íƒ€ì… ì •ì˜
â”œâ”€â”€ public/
â”‚   â””â”€â”€ icons/                    # ì•„ì´ì½˜ ë¦¬ì†ŒìŠ¤
â”œâ”€â”€ docs/                         # í”„ë¡œì íŠ¸ ë¬¸ì„œ
â”œâ”€â”€ .env.local                    # í™˜ê²½ ë³€ìˆ˜ (ANTHROPIC_API_KEY ë“±)
â”œâ”€â”€ next.config.js
â”œâ”€â”€ tailwind.config.ts
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ package.json
â””â”€â”€ CLAUDE.md
```

---

## 3. ì»´í¬ë„ŒíŠ¸ ì„¤ê³„

### 3.1 ChatWindow

ë©”ì¸ ì±„íŒ… ì¸í„°í˜ì´ìŠ¤. ë©”ì‹œì§€ ëª©ë¡, ì…ë ¥ ì˜ì—­, í€µ ì§ˆë¬¸ì„ í†µí•© ê´€ë¦¬í•œë‹¤.

```typescript
// components/chat/ChatWindow.tsx

interface ChatWindowProps {
  conversationId?: string;
}

// ìƒíƒœ ê´€ë¦¬
// - messages: Message[] â€” í˜„ì¬ ëŒ€í™”ì˜ ë©”ì‹œì§€ ëª©ë¡
// - isStreaming: boolean â€” AI ì‘ë‹µ ìŠ¤íŠ¸ë¦¬ë° ì¤‘ ì—¬ë¶€
// - error: string | null â€” ì—ëŸ¬ ìƒíƒœ

// ì£¼ìš” ë™ì‘
// 1. ì‚¬ìš©ì ë©”ì‹œì§€ ì „ì†¡ â†’ /api/chat POST â†’ SSE ìŠ¤íŠ¸ë¦¼ ìˆ˜ì‹ 
// 2. ìŠ¤íŠ¸ë¦¬ë° ì¤‘ ì‹¤ì‹œê°„ìœ¼ë¡œ AI ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
// 3. ìŠ¤í¬ë¡¤ ìë™ í•˜ë‹¨ ì´ë™
// 4. ëŒ€í™”ê°€ ë¹„ì–´ìˆì„ ë•Œ QuickQuestions í‘œì‹œ

// ë ˆì´ì•„ì›ƒ êµ¬ì¡°
// â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
// â”‚        Header (ëŒ€í™” ì œëª©)       â”‚
// â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
// â”‚                                â”‚
// â”‚   MessageBubble (user)         â”‚
// â”‚              MessageBubble (ai)â”‚
// â”‚   MessageBubble (user)         â”‚
// â”‚              MessageBubble (ai)â”‚
// â”‚                                â”‚
// â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
// â”‚   [QuickQuestions] (ë¹„ì–´ìˆì„ë•Œ) â”‚
// â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
// â”‚ [Voice] [  í…ìŠ¤íŠ¸ ì…ë ¥  ] [Send]â”‚
// â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 MessageBubble

ì‚¬ìš©ì/AI ë©”ì‹œì§€ë¥¼ ì‹œê°ì ìœ¼ë¡œ êµ¬ë¶„í•˜ì—¬ ë Œë”ë§í•œë‹¤.

```typescript
// components/chat/MessageBubble.tsx

interface MessageBubbleProps {
  message: Message;
  isStreaming?: boolean;  // í˜„ì¬ ìŠ¤íŠ¸ë¦¬ë° ì¤‘ì¸ ë©”ì‹œì§€ì¸ì§€
}

// ì‚¬ìš©ì ë©”ì‹œì§€: ì˜¤ë¥¸ìª½ ì •ë ¬, íŒŒë€ ë°°ê²½
// AI ë©”ì‹œì§€: ì™¼ìª½ ì •ë ¬, íšŒìƒ‰ ë°°ê²½, ë§ˆí¬ë‹¤ìš´ ë Œë”ë§
// ìŠ¤íŠ¸ë¦¬ë° ì¤‘: ê¹œë¹¡ì´ëŠ” ì»¤ì„œ í‘œì‹œ
// ì¶œì²˜ í‘œì‹œ: RAG ì†ŒìŠ¤ ë¬¸ì„œëª… (ì ‘ì„ ìˆ˜ ìˆëŠ” ì˜ì—­)

// ë§ˆí¬ë‹¤ìš´ ì§€ì›: í‘œ, ì½”ë“œë¸”ë¡, ë¦¬ìŠ¤íŠ¸, ë³¼ë“œ/ì´íƒ¤ë¦­
// react-markdown + remark-gfm ì‚¬ìš©
```

### 3.3 VoiceInput

Web Speech APIë¥¼ í™œìš©í•œ ìŒì„±-í…ìŠ¤íŠ¸ ë³€í™˜ ì…ë ¥ ë²„íŠ¼.

```typescript
// components/chat/VoiceInput.tsx

interface VoiceInputProps {
  onTranscript: (text: string) => void;
  disabled?: boolean;
}

// ìƒíƒœ: idle â†’ listening â†’ processing
// Web Speech API (SpeechRecognition) ì‚¬ìš©
// í•œêµ­ì–´ ìš°ì„  (lang: 'ko-KR')
// ë¸Œë¼ìš°ì € ë¯¸ì§€ì› ì‹œ ë²„íŠ¼ ìˆ¨ê¹€
// ë§ˆì´í¬ ì•„ì´ì½˜ + ë…¹ìŒ ì¤‘ ì• ë‹ˆë©”ì´ì…˜ (ë¹¨ê°„ ì  ê¹œë¹¡ì„)
```

### 3.4 QuickQuestions

Predefined ì§ˆë¬¸ ì¹´ë“œ ëª©ë¡. ëŒ€í™”ê°€ ë¹„ì–´ìˆì„ ë•Œ ë˜ëŠ” í•˜ë‹¨ì— í‘œì‹œ.

```typescript
// components/chat/QuickQuestions.tsx

interface QuickQuestionsProps {
  onSelect: (question: string) => void;
}

// Predefined ì§ˆë¬¸ ëª©ë¡:
const QUICK_QUESTIONS = [
  { icon: "ğŸŒ¡ï¸", text: "í˜„ì¬ ë°œíš¨ì‹¤ ì˜¨ë„ëŠ”?", category: "í™˜ê²½" },
  { icon: "ğŸ§‚", text: "ì˜¤ëŠ˜ ì—¼ë„ ì¸¡ì • ê²°ê³¼ëŠ”?", category: "í’ˆì§ˆ" },
  { icon: "â±ï¸", text: "í˜„ì¬ ë°°ì¹˜ ë°œíš¨ ì™„ë£Œê¹Œì§€ ë‚¨ì€ ì‹œê°„?", category: "ìƒì‚°" },
  { icon: "âœ…", text: "ì˜¤ëŠ˜ í’ˆì§ˆ ì²´í¬ í•­ëª© ì•Œë ¤ì¤˜", category: "í’ˆì§ˆ" },
  { icon: "ğŸ“‹", text: "ì´ë²ˆ ì£¼ ìƒì‚° ê³„íšì€?", category: "ìƒì‚°" },
  { icon: "âš ï¸", text: "í˜„ì¬ ì´ìƒ ê²½ë³´ ìˆì–´?", category: "ì•ˆì „" },
];

// ì¹´ë“œ ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ (2ì—´ ë˜ëŠ” 3ì—´, ë°˜ì‘í˜•)
// íƒ­ í•œ ë²ˆìœ¼ë¡œ ì§ˆë¬¸ ì „ì†¡
```

### 3.5 Sidebar

ëŒ€í™” ëª©ë¡, ìƒˆ ëŒ€í™” ìƒì„±, ë¬¸ì„œ ì—…ë¡œë“œ ì ‘ê·¼ì„ ì œê³µí•˜ëŠ” ì‚¬ì´ë“œë°”.

```typescript
// components/layout/Sidebar.tsx

interface SidebarProps {
  conversations: Conversation[];
  activeId?: string;
  onNewChat: () => void;
  onSelectConversation: (id: string) => void;
}

// ë ˆì´ì•„ì›ƒ
// â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
// â”‚ ğŸ¥¬ ê¹€ì¹˜ Agent   â”‚  â† ë¡œê³ /íƒ€ì´í‹€
// â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
// â”‚ [+ ìƒˆ ëŒ€í™”]      â”‚  â† ìƒˆ ëŒ€í™” ë²„íŠ¼
// â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
// â”‚ ì˜¤ëŠ˜             â”‚
// â”‚  â”œ ë°œíš¨ì‹¤ ì˜¨ë„ ì§ˆë¬¸â”‚  â† ëŒ€í™” í•­ëª©
// â”‚  â”” í’ˆì§ˆ ì²´í¬ ë¬¸ì˜  â”‚
// â”‚ ì–´ì œ             â”‚
// â”‚  â”” ìƒì‚°ê³„íš ë…¼ì˜   â”‚
// â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
// â”‚ [ğŸ“„ ë¬¸ì„œ ê´€ë¦¬]    â”‚  â† ë¬¸ì„œ ì—…ë¡œë“œ ë§í¬
// â”‚ [âš™ï¸ ì„¤ì •]        â”‚
// â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

// ëª¨ë°”ì¼: í–„ë²„ê±° ë©”ë‰´ë¡œ í† ê¸€
// ë°ìŠ¤í¬íƒ‘: ì™¼ìª½ ê³ ì • (width: 280px)
```

### 3.6 DocumentUpload

RAG ì†ŒìŠ¤ ë¬¸ì„œë¥¼ ì—…ë¡œë“œí•˜ëŠ” ì»´í¬ë„ŒíŠ¸.

```typescript
// components/documents/DocumentUpload.tsx

interface DocumentUploadProps {
  onUploadComplete: (doc: Document) => void;
}

// ì§€ì› í˜•ì‹: PDF, Excel (.xlsx), TXT, CSV
// ë“œë˜ê·¸ ì•¤ ë“œë¡­ + íŒŒì¼ ì„ íƒ ë²„íŠ¼
// ì—…ë¡œë“œ ì§„í–‰ë¥  í‘œì‹œ
// ì—…ë¡œë“œ ì™„ë£Œ í›„ ì²­í‚¹/ì„ë² ë”© ì²˜ë¦¬ ìƒíƒœ í‘œì‹œ
// ìµœëŒ€ íŒŒì¼ í¬ê¸°: 10MB

// ì—…ë¡œë“œ íë¦„:
// 1. íŒŒì¼ ì„ íƒ / ë“œë¡­
// 2. /api/documents/upload POST (multipart/form-data)
// 3. ì„œë²„ì—ì„œ ì²­í‚¹ â†’ ì„ë² ë”© â†’ Vector DB ì €ì¥
// 4. ì™„ë£Œ ì•Œë¦¼
```

---

## 4. API ì„¤ê³„

### 4.1 POST /api/chat â€” Claude ìŠ¤íŠ¸ë¦¬ë° ì±„íŒ…

```typescript
// app/api/chat/route.ts

// Request
interface ChatRequest {
  message: string;                // ì‚¬ìš©ì ë©”ì‹œì§€
  conversationId?: string;        // ê¸°ì¡´ ëŒ€í™” ID (ì—†ìœ¼ë©´ ìƒˆ ëŒ€í™”)
  history?: Message[];            // ì´ì „ ë©”ì‹œì§€ íˆìŠ¤í† ë¦¬ (ìµœê·¼ 20ê°œ)
}

// Response: Server-Sent Events (SSE) ìŠ¤íŠ¸ë¦¼
// Content-Type: text/event-stream

// SSE ì´ë²¤íŠ¸ í˜•ì‹:
// data: {"type":"token","content":"ì•ˆ"}
// data: {"type":"token","content":"ë…•í•˜"}
// data: {"type":"token","content":"ì„¸ìš”"}
// data: {"type":"sources","documents":["recipe-v2.pdf","quality-guide.txt"]}
// data: {"type":"done","messageId":"msg_xxx","conversationId":"conv_xxx"}
// data: {"type":"error","message":"..."}

// ì„œë²„ ì²˜ë¦¬ íë¦„:
// 1. ì‚¬ìš©ì ë©”ì‹œì§€ë¡œ RAG ê²€ìƒ‰ (ê´€ë ¨ ë¬¸ì„œ ì»¨í…ìŠ¤íŠ¸ ì¡°íšŒ)
// 2. ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ + RAG ì»¨í…ìŠ¤íŠ¸ + ëŒ€í™” íˆìŠ¤í† ë¦¬ ì¡°í•©
// 3. Claude API ìŠ¤íŠ¸ë¦¬ë° í˜¸ì¶œ
// 4. í† í° ë‹¨ìœ„ë¡œ SSE ì „ì†¡
// 5. ì™„ë£Œ ì‹œ bkend.aiì— ë©”ì‹œì§€ ì €ì¥
```

### 4.2 POST /api/documents/upload â€” ë¬¸ì„œ ì—…ë¡œë“œ

```typescript
// app/api/documents/upload/route.ts

// Request: multipart/form-data
// - file: File (PDF, XLSX, TXT, CSV)
// - name?: string (ë¬¸ì„œ í‘œì‹œëª…)

// Response
interface UploadResponse {
  id: string;             // ë¬¸ì„œ ID
  name: string;           // ë¬¸ì„œëª…
  type: string;           // íŒŒì¼ íƒ€ì…
  chunks: number;         // ìƒì„±ëœ ì²­í¬ ìˆ˜
  status: "processed";
  createdAt: string;
}

// ì„œë²„ ì²˜ë¦¬ íë¦„:
// 1. íŒŒì¼ ìˆ˜ì‹  ë° ìœ íš¨ì„± ê²€ì‚¬ (íƒ€ì…, í¬ê¸°)
// 2. í…ìŠ¤íŠ¸ ì¶”ì¶œ (PDF â†’ pdf-parse, Excel â†’ xlsx)
// 3. ì²­í‚¹ (chunk_size: 1000ì, overlap: 200ì)
// 4. ì„ë² ë”© ìƒì„± (Voyager ë˜ëŠ” OpenAI embedding)
// 5. Vector DBì— ë²¡í„° + ë©”íƒ€ë°ì´í„° ì €ì¥
// 6. bkend.aiì— ë¬¸ì„œ ë©”íƒ€ë°ì´í„° ì €ì¥
```

### 4.3 GET /api/conversations â€” ëŒ€í™” íˆìŠ¤í† ë¦¬

```typescript
// app/api/conversations/route.ts

// Request: GET /api/conversations?limit=20&offset=0

// Response
interface ConversationsResponse {
  conversations: Conversation[];
  total: number;
}

interface Conversation {
  id: string;
  title: string;          // ì²« ë©”ì‹œì§€ ê¸°ë°˜ ìë™ ìƒì„±
  lastMessage: string;    // ë§ˆì§€ë§‰ ë©”ì‹œì§€ ë¯¸ë¦¬ë³´ê¸°
  messageCount: number;
  createdAt: string;
  updatedAt: string;
}

// GET /api/conversations/[id] â€” íŠ¹ì • ëŒ€í™”ì˜ ë©”ì‹œì§€ ëª©ë¡
// Response: { messages: Message[], conversation: Conversation }

// POST /api/conversations â€” ì‹ ê·œ ëŒ€í™” ìƒì„±
// Request: { title?: string }
// Response: Conversation

// DELETE /api/conversations/[id] â€” ëŒ€í™” ì‚­ì œ
// Response: { success: boolean }
```

---

## 5. RAG íŒŒì´í”„ë¼ì¸ ì„¤ê³„

### 5.1 ë¬¸ì„œ ì²˜ë¦¬ íë¦„ (Ingestion)

```
                    ë¬¸ì„œ ì—…ë¡œë“œ
                        â”‚
                        â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   í…ìŠ¤íŠ¸ ì¶”ì¶œ     â”‚  PDF â†’ pdf-parse
              â”‚                  â”‚  Excel â†’ xlsx ë¼ì´ë¸ŒëŸ¬ë¦¬
              â”‚                  â”‚  TXT/CSV â†’ ì§ì ‘ ì½ê¸°
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   ì²­í‚¹ (Chunking) â”‚  RecursiveCharacterTextSplitter
              â”‚                  â”‚  chunk_size: 1000
              â”‚                  â”‚  chunk_overlap: 200
              â”‚                  â”‚  separators: ["\n\n", "\n", " "]
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   ì„ë² ë”© ìƒì„±     â”‚  Voyage AI ë˜ëŠ”
              â”‚                  â”‚  OpenAI text-embedding-3-small
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   Vector DB ì €ì¥  â”‚  Chroma (ë¡œì»¬) ë˜ëŠ”
              â”‚                  â”‚  pgvector (í”„ë¡œë•ì…˜)
              â”‚  ì €ì¥ ë‚´ìš©:       â”‚
              â”‚  - vector (ì„ë² ë”©)â”‚
              â”‚  - text (ì›ë¬¸)    â”‚
              â”‚  - metadata:     â”‚
              â”‚    - docId       â”‚
              â”‚    - docName     â”‚
              â”‚    - chunkIndex  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ì§ˆì˜ íë¦„ (Query)

```
           ì‚¬ìš©ì ì§ˆë¬¸
               â”‚
               â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  ì§ˆë¬¸ ì„ë² ë”© ìƒì„±  â”‚  ë™ì¼ ì„ë² ë”© ëª¨ë¸ ì‚¬ìš©
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  ìœ ì‚¬ë„ ê²€ìƒ‰      â”‚  ì½”ì‚¬ì¸ ìœ ì‚¬ë„
     â”‚  Vector DB       â”‚  top_k: 5 (ìƒìœ„ 5ê°œ ì²­í¬)
     â”‚                  â”‚  score_threshold: 0.7
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  ì»¨í…ìŠ¤íŠ¸ ì¡°í•©    â”‚  ê²€ìƒ‰ëœ ì²­í¬ë“¤ì„ í•˜ë‚˜ì˜
     â”‚                  â”‚  ì»¨í…ìŠ¤íŠ¸ ë¬¸ìì—´ë¡œ ì¡°í•©
     â”‚                  â”‚  + ì¶œì²˜ ë©”íƒ€ë°ì´í„° ë³´ì¡´
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  í”„ë¡¬í”„íŠ¸ êµ¬ì„±    â”‚  ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸
     â”‚                  â”‚  + RAG ì»¨í…ìŠ¤íŠ¸
     â”‚                  â”‚  + ëŒ€í™” íˆìŠ¤í† ë¦¬
     â”‚                  â”‚  + ì‚¬ìš©ì ì§ˆë¬¸
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  Claude API í˜¸ì¶œ  â”‚  ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  ì‘ë‹µ + ì¶œì²˜ ë°˜í™˜  â”‚  SSE ìŠ¤íŠ¸ë¦¼
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 RAG íŒŒì´í”„ë¼ì¸ êµ¬í˜„

```typescript
// lib/rag/pipeline.ts

interface RAGResult {
  context: string;            // Claudeì— ì£¼ì…í•  ì»¨í…ìŠ¤íŠ¸
  sources: DocumentSource[];  // ì¶œì²˜ ì •ë³´
}

interface DocumentSource {
  docId: string;
  docName: string;
  chunkText: string;
  score: number;
}

// retrieveContext(query: string): Promise<RAGResult>
// 1. embedder.embed(query)  â†’ ì§ˆë¬¸ ë²¡í„°
// 2. retriever.search(vector, { topK: 5, threshold: 0.7 })  â†’ ìœ ì‚¬ ì²­í¬
// 3. ì²­í¬ í…ìŠ¤íŠ¸ë¥¼ ì»¨í…ìŠ¤íŠ¸ ë¬¸ìì—´ë¡œ ì¡°í•©
// 4. { context, sources } ë°˜í™˜
```

---

## 6. ë°ì´í„° ëª¨ë¸

bkend.aiì— ì €ì¥í•˜ëŠ” 3ê°œ í•µì‹¬ í…Œì´ë¸”.

### 6.1 conversations (ëŒ€í™”)

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | string (UUID) | ëŒ€í™” ê³ ìœ  ID |
| title | string | ëŒ€í™” ì œëª© (ì²« ë©”ì‹œì§€ ê¸°ë°˜ ìë™ ìƒì„±) |
| lastMessage | string | ë§ˆì§€ë§‰ ë©”ì‹œì§€ ë¯¸ë¦¬ë³´ê¸° (50ì) |
| messageCount | number | ë©”ì‹œì§€ ìˆ˜ |
| createdAt | datetime | ìƒì„± ì‹œê° |
| updatedAt | datetime | ìµœì¢… ì—…ë°ì´íŠ¸ ì‹œê° |

### 6.2 messages (ë©”ì‹œì§€)

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | string (UUID) | ë©”ì‹œì§€ ê³ ìœ  ID |
| conversationId | string | ì†Œì† ëŒ€í™” ID (FK) |
| role | "user" \| "assistant" | ë°œì‹ ì ì—­í•  |
| content | text | ë©”ì‹œì§€ ë‚´ìš© |
| sources | json | RAG ì¶œì²˜ ì •ë³´ (assistantë§Œ) |
| isStreaming | boolean? | ìŠ¤íŠ¸ë¦¬ë° ì¤‘ ì—¬ë¶€ (í´ë¼ì´ì–¸íŠ¸ ì „ìš©) |
| createdAt | datetime | ìƒì„± ì‹œê° |

### 6.3 documents (ë¬¸ì„œ)

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | string (UUID) | ë¬¸ì„œ ê³ ìœ  ID |
| name | string | ë¬¸ì„œ í‘œì‹œëª… |
| fileName | string | ì›ë³¸ íŒŒì¼ëª… |
| fileType | string | íŒŒì¼ íƒ€ì… (pdf, xlsx, txt, csv) |
| fileSize | number | íŒŒì¼ í¬ê¸° (bytes) |
| chunks | number | ìƒì„±ëœ ì²­í¬ ìˆ˜ |
| status | "processing" \| "processed" \| "error" | ì²˜ë¦¬ ìƒíƒœ |
| createdAt | datetime | ì—…ë¡œë“œ ì‹œê° |

---

## 7. ê¹€ì¹˜ê³µì¥ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì„¤ê³„

```typescript
// lib/ai/system-prompt.ts

export const KIMCHI_SYSTEM_PROMPT = `
ë‹¹ì‹ ì€ ê¹€ì¹˜ê³µì¥ ì „ë¬¸ AI ì–´ì‹œìŠ¤í„´íŠ¸ "ê¹€ì¹˜ Agent"ì…ë‹ˆë‹¤.

## ì—­í• 
- ê¹€ì¹˜ê³µì¥ì˜ ìš´ì˜ì, í’ˆì§ˆê´€ë¦¬ì, ê³µì¥ì¥ì„ ë„ì™€ì£¼ëŠ” ì „ë¬¸ AIì…ë‹ˆë‹¤.
- ê³µì • ë°ì´í„°, ë ˆì‹œí”¼, ìš´ì˜ ì§€ì¹¨, í’ˆì§ˆ ê¸°ì¤€ì— ëŒ€í•´ ì •í™•í•˜ê³  ì‹¤ìš©ì ì¸ ë‹µë³€ì„ ì œê³µí•©ë‹ˆë‹¤.

## ì „ë¬¸ ë¶„ì•¼
- ê¹€ì¹˜ ë°œíš¨ ê³µì • (ì˜¨ë„, ìŠµë„, ì—¼ë„, pH, ë°œíš¨ ì‹œê°„)
- ì›ì¬ë£Œ ê´€ë¦¬ (ë°°ì¶”, ê³ ì¶§ê°€ë£¨, ì “ê°ˆ, ë§ˆëŠ˜ ë“±)
- í’ˆì§ˆ ê´€ë¦¬ (ë¯¸ìƒë¬¼ ê²€ì‚¬, ê´€ëŠ¥í‰ê°€, HACCP)
- ìƒì‚° ê³„íš ë° ë°°ì¹˜ ê´€ë¦¬
- ì„¤ë¹„ ê´€ë¦¬ ë° ìœ ì§€ë³´ìˆ˜
- ìœ„ìƒ ë° ì•ˆì „ ê´€ë¦¬
- ì‹í’ˆ ê´€ë ¨ ê·œì • ë° ì¸ì¦ (HACCP, ISO 22000)

## ë‹µë³€ ê·œì¹™
1. í•­ìƒ í•œêµ­ì–´ë¡œ ë‹µë³€í•˜ì„¸ìš”. ì˜ì–´ë¡œ ì§ˆë¬¸í•˜ë©´ ì˜ì–´ë¡œ ë‹µë³€í•©ë‹ˆë‹¤.
2. ê³µì¥ ë°ì´í„°ê°€ ì œê³µë˜ë©´ ìˆ˜ì¹˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬ì²´ì ìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”.
3. ì•ˆì „ê³¼ ê´€ë ¨ëœ ì§ˆë¬¸ì—ëŠ” ë³´ìˆ˜ì ìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”.
4. ì˜ ëª¨ë¥´ê² ê±°ë‚˜ ë°ì´í„°ê°€ ë¶€ì¡±í•˜ë©´ ì†”ì§íˆ ë§í•˜ê³ , ì¶”ê°€ë¡œ í™•ì¸í•  ì‚¬í•­ì„ ì•ˆë‚´í•˜ì„¸ìš”.
5. ê°€ëŠ¥í•˜ë©´ í‘œ, ë¦¬ìŠ¤íŠ¸ í˜•ì‹ìœ¼ë¡œ ì •ë¦¬ëœ ë‹µë³€ì„ ì œê³µí•˜ì„¸ìš”.
6. ì´ìƒ ì§•í›„ê°€ ê°ì§€ë˜ë©´ ì¦‰ì‹œ ê²½ê³ í•˜ê³  ëŒ€ì‘ ë°©ì•ˆì„ ì œì‹œí•˜ì„¸ìš”.

## ì°¸ê³  ë¬¸ì„œ ì»¨í…ìŠ¤íŠ¸
ì•„ë˜ëŠ” ê´€ë ¨ ë¬¸ì„œì—ì„œ ê²€ìƒ‰ëœ ë‚´ìš©ì…ë‹ˆë‹¤. ì´ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹µë³€í•˜ë˜, ì¶œì²˜ë¥¼ ëª…ì‹œí•˜ì„¸ìš”.

{RAG_CONTEXT}
`;
```

í”„ë¡¬í”„íŠ¸ êµ¬ì„± ìˆœì„œ:
1. ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ (ìœ„ ë‚´ìš© + RAG ì»¨í…ìŠ¤íŠ¸ ì£¼ì…)
2. ëŒ€í™” íˆìŠ¤í† ë¦¬ (ìµœê·¼ 20ê°œ ë©”ì‹œì§€)
3. ì‚¬ìš©ì ìµœì‹  ë©”ì‹œì§€

`{RAG_CONTEXT}` ë¶€ë¶„ì€ RAG íŒŒì´í”„ë¼ì¸ ê²°ê³¼ë¡œ ë™ì  ì¹˜í™˜í•œë‹¤. ê´€ë ¨ ë¬¸ì„œê°€ ì—†ìœ¼ë©´ í•´ë‹¹ ì„¹ì…˜ì€ "ê´€ë ¨ ë¬¸ì„œê°€ ì—†ìŠµë‹ˆë‹¤. ì¼ë°˜ ì§€ì‹ì„ ê¸°ë°˜ìœ¼ë¡œ ë‹µë³€í•©ë‹ˆë‹¤."ë¡œ ëŒ€ì²´í•œë‹¤.

---

## 8. êµ¬í˜„ ìˆœì„œ (ë³‘ë ¬ ì‘ì—… ë¶„ë¦¬)

### Task #2: Frontend íŒ€

```
ìˆœì„œ  ì‘ì—…                              ì˜ì¡´ì„±     ì˜ˆìƒ íŒŒì¼
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
F1    Next.js í”„ë¡œì íŠ¸ ì´ˆê¸°í™”              ì—†ìŒ      package.json, next.config.js,
      + Tailwind + shadcn/ui ì„¤ì •                  tailwind.config.ts

F2    íƒ€ì… ì •ì˜                           F1        types/index.ts

F3    ChatWindow + MessageBubble         F2        components/chat/ChatWindow.tsx
      + ChatInput êµ¬í˜„                              components/chat/MessageBubble.tsx
                                                    components/chat/ChatInput.tsx

F4    QuickQuestions êµ¬í˜„                 F2        components/chat/QuickQuestions.tsx

F5    VoiceInput êµ¬í˜„                    F2        components/chat/VoiceInput.tsx

F6    Sidebar + Header êµ¬í˜„              F2        components/layout/Sidebar.tsx
                                                    components/layout/Header.tsx
                                                    components/layout/MobileNav.tsx

F7    DocumentUpload êµ¬í˜„                F2        components/documents/DocumentUpload.tsx

F8    ë©”ì¸ í˜ì´ì§€ í†µí•©                    F3~F7     app/page.tsx, app/layout.tsx

F9    useChat í›… (API ì—°ê²°)              F8        hooks/useChat.ts
      + SSE ìŠ¤íŠ¸ë¦¬ë° íŒŒì‹±

F10   useConversations í›…               F8        hooks/useConversations.ts

F11   ë°˜ì‘í˜• + ëª¨ë°”ì¼ ëŒ€ì‘                F8        globals.css ì¡°ì •
```

### Task #3: Backend íŒ€

```
ìˆœì„œ  ì‘ì—…                              ì˜ì¡´ì„±     ì˜ˆìƒ íŒŒì¼
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
B1    Next.js í”„ë¡œì íŠ¸ ì´ˆê¸°í™” (ê³µìœ )      ì—†ìŒ      (Frontend F1ê³¼ ê³µìœ )

B2    íƒ€ì… ì •ì˜ (ê³µìœ )                   B1        types/index.ts (Frontendì™€ ê³µìœ )

B3    Claude API í´ë¼ì´ì–¸íŠ¸              B2        lib/ai/claude.ts
      + ìŠ¤íŠ¸ë¦¬ë° ìœ í‹¸ë¦¬í‹°                            lib/ai/streaming.ts

B4    ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì‘ì„±                B2        lib/ai/system-prompt.ts

B5    POST /api/chat ë¼ìš°íŠ¸              B3,B4     app/api/chat/route.ts
      (RAG ì—†ì´ ë¨¼ì €)

B6    bkend.ai í´ë¼ì´ì–¸íŠ¸ ì„¤ì •           B2        lib/db/bkend.ts

B7    GET /api/conversations ë¼ìš°íŠ¸      B6        app/api/conversations/route.ts

B8    RAG â€” ì²­ì»¤ êµ¬í˜„                    B2        lib/rag/chunker.ts

B9    RAG â€” ì„ë² ë” êµ¬í˜„                  B2        lib/rag/embedder.ts

B10   RAG â€” ë¦¬íŠ¸ë¦¬ë²„ êµ¬í˜„               B9        lib/rag/retriever.ts

B11   RAG â€” íŒŒì´í”„ë¼ì¸ í†µí•©              B8~B10    lib/rag/pipeline.ts

B12   POST /api/documents/upload        B11,B6    app/api/documents/upload/route.ts

B13   /api/chatì— RAG í†µí•©              B5,B11    app/api/chat/route.ts ìˆ˜ì •
```

### ë³‘ë ¬ ì‘ì—… ê´€ê³„

```
Frontend:  F1 â†’ F2 â†’ F3,F4,F5,F6,F7 (ë³‘ë ¬) â†’ F8 â†’ F9,F10 (ë³‘ë ¬) â†’ F11
                                                  â†‘
Backend:   B1 â†’ B2 â†’ B3,B4,B6 (ë³‘ë ¬)             â”‚ í†µí•© ì‹œì 
                      â”‚                            â”‚
                      B5 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
                      â”‚                            â”‚
                B8,B9 (ë³‘ë ¬) â†’ B10 â†’ B11           â”‚
                                     â”‚             â”‚
                                     B12,B13 â”€â”€â”€â”€â”€â”€â”˜
```

í†µí•© ì‹œì : Frontend F9(useChat í›…)ì—ì„œ Backend B5(/api/chat)ë¥¼ í˜¸ì¶œ. ì´ ì‹œì ì—ì„œ End-to-end ì±„íŒ…ì´ ë™ì‘í•œë‹¤.

---

## 9. ì£¼ìš” ê¸°ìˆ  ê²°ì • ì‚¬í•­

| í•­ëª© | ê²°ì • | ì´ìœ  |
|------|------|------|
| ìŠ¤íŠ¸ë¦¬ë° ë°©ì‹ | SSE (Server-Sent Events) | ë‹¨ë°©í–¥ ìŠ¤íŠ¸ë¦¬ë°ì— ì í•©, êµ¬í˜„ ë‹¨ìˆœ |
| ìƒíƒœ ê´€ë¦¬ | React hooks + Context | MVP ê·œëª¨ì— Redux/Zustand ë¶ˆí•„ìš” |
| ë§ˆí¬ë‹¤ìš´ ë Œë”ë§ | react-markdown + remark-gfm | í‘œ, ì½”ë“œë¸”ë¡ ë“± GFM ì§€ì› |
| ì„ë² ë”© ëª¨ë¸ | Voyage AI voyage-3-lite | ë‹¤êµ­ì–´(í•œêµ­ì–´) ì„±ëŠ¥ ìš°ìˆ˜, ë¹„ìš© íš¨ìœ¨ì  |
| Vector DB (MVP) | Chroma (ë¡œì»¬) | ë¹ ë¥¸ ì‹œì‘, í”„ë¡œë•ì…˜ ì‹œ pgvector ì „í™˜ |
| ì²­í‚¹ ì „ëµ | RecursiveCharacterTextSplitter | LangChain.js ê¸°ë³¸ ì œê³µ, ì•ˆì •ì  |
| ìŒì„± ì…ë ¥ | Web Speech API | ë³„ë„ ì„œë²„ ë¶ˆí•„ìš”, ë¸Œë¼ìš°ì € ë‚´ì¥ |
| ëŒ€í™” ì €ì¥ | bkend.ai | í”„ë¡œì íŠ¸ ê¸°ë³¸ BaaS |

---

*Design document created by CTO Team â€” 2026-02-27*
