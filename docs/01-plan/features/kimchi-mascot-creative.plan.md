# kimchi-mascot-creative Planning Document

> **Summary**: 김치군 마스코트 창의적 기능 확장 — 레벨업 시스템, 계절/이벤트 모드, 인터랙션, 공장 공정 연동, 음성 효과음, 야간 모드 강화, 성취 배지 시스템
>
> **Project**: Kimchi-Agent (김치군 마스코트 크리에이티브 확장)
> **Version**: 1.0.0
> **Author**: kimchi-mascot-creative Team
> **Date**: 2026-02-28
> **Status**: Draft

---

## 1. Overview

### 1.1 Purpose

김치군 마스코트(97.0% Match Rate, 7감정 상태, 47개 대사, CustomEvent 기반)의 완성도 위에서 **사용자 참여도(Engagement)와 감정적 연결(Emotional Bonding)을 극대화**하는 창의적 기능을 추가한다. 단순한 상태 표시기를 넘어, 공장 직원들이 매일 출근하고 싶어지는 **살아 있는 캐릭터**로 진화시키는 것이 목표다.

### 1.2 Current State (기반)

| 구성요소 | 현황 |
|---------|------|
| 감정 상태 | 7종: idle/thinking/success/error/celebrating/searching/sleeping |
| 대사 | 47개 한국어 공장 감성 대사 |
| SVG | 배추 형태, 입/눈/팔/다리 + 상태별 애니메이션 |
| 이벤트 | CustomEvent `kimchi-mascot` 기반 완전 분리 |
| 야간 모드 | 22:00~06:00 sleeping 상태 자동 진입 |
| 설정 | LocalStorage 기반 ON/OFF + 말풍선 음소거 |
| 비행 | Framer Motion spring 물리 기반 자유비행 |

### 1.3 Creative Vision

> "김치군은 AI 어시스턴트가 아니라 공장의 막내 직원이다."

공장 직원들이 김치군에게 친밀감을 느끼고, 성장을 함께 지켜보며, 계절마다 달라지는 모습을 기대하게 만드는 경험을 설계한다. 게임화(Gamification) 요소를 도입하되, 복잡하지 않고 자연스럽게 녹아드는 방식을 채택한다.

---

## 2. Feature Specifications

---

### Feature 1: 레벨업 시스템 (Growth System)

#### 2.1 개요

사용 횟수에 따라 김치군이 4단계로 성장한다. 단순한 숫자 증가가 아니라 SVG 외형 변화 + 새로운 대사 + 특별 모션으로 성장을 시각적으로 체험하게 한다.

#### 2.2 성장 단계

| 레벨 | 이름 | 필요 사용 횟수 | 외형 특징 | 해금 콘텐츠 |
|------|------|-------------|----------|-----------|
| Lv.1 | 새싹김치군 | 0회 ~ 49회 | 현재 기본 배추 SVG | 기본 47개 대사 |
| Lv.2 | 배추김치군 | 50회 ~ 199회 | 잎사귀 더 풍성 + 볼터치 진해짐 | +15개 대사 (자신감 UP) |
| Lv.3 | 파김치군 | 200회 ~ 499회 | 빨간 양념 반점 추가 + 눈 더 크게 | +20개 대사 (프로 느낌) |
| Lv.4 | 숙성김치군 | 500회+ | 황금빛 글로우 + 왕관 장식 | +25개 대사 (김치 마스터) + 특별 효과 |

**"사용 횟수" 카운팅 기준:**
- 채팅 메시지 전송 1회 = +1
- 문서 업로드 성공 = +3
- 하루 첫 접속 = +1 (데일리 보너스)

#### 2.3 레벨업 이벤트

레벨업 시 전체 화면에 짧은 연출(1.5초):
- 화면 중앙에 김치군 크게 등장 + 파티클 효과
- 레벨업 대사 (예: "드디어 배추김치군이 됐어요!")
- celebrating 상태 3회 연속 비행

#### 2.4 사용자 스토리

**UC-01**: 공장 직원으로서, 매일 AI를 사용할수록 김치군이 성장하는 것을 보고 싶다. 그래서 더 자주 사용하게 된다.

**UC-02**: 시스템 관리자로서, 사용 현황을 김치군 레벨로 간접적으로 파악하고 싶다. 레벨이 높다는 것은 활발히 사용 중임을 의미한다.

#### 2.5 비즈니스 가치

- 일일 활성 사용자(DAU) 증가 예상: +20~30% (게임화 효과)
- 시스템 도입 후 이탈률 감소 (김치군 레벨에 대한 소유감)
- RAG 데이터 품질 향상 (문서 업로드 보너스로 인한 업로드 증가)

#### 2.6 구현 복잡도

**High** — SVG 변형 (4세트), 카운팅 스토어 (LocalStorage), 레벨업 애니메이션, 레벨별 대사 관리

#### 2.7 우선순위

**P1** — 참여도 직결 핵심 기능, 다른 기능의 기반이 됨

---

### Feature 2: 계절/이벤트 모드 (Seasonal & Event Mode)

#### 2.1 개요

한국 공장 문화의 계절감과 명절을 반영한 특별 모드. 특정 날짜/시간에 자동으로 의상/분위기가 바뀌어 신선함을 유지한다.

#### 2.2 이벤트 정의

| 이벤트 | 기간/조건 | 외형 변화 | 특별 대사 예시 |
|--------|---------|---------|------------|
| 김장철 | 11월 한 달 | 빨간 앞치마 + 고무장갑 | "이 계절엔 김치군도 바빠요!" |
| 설날 | 음력 1/1 ~ 1/3 | 한복 저고리 색상 + 복주머니 | "새해 복 많이 받으세요!" |
| 추석 | 음력 8/15 ~ 8/17 | 한복 + 달 모티프 | "풍성한 한가위 되세요!" |
| 월요일 아침 | 월~금, 07~09시 | 출근 가방 소품 | "월요일이지만 파이팅이에요!" |
| 금요일 저녁 | 금요일 17~19시 | 선글라스 + 느긋한 포즈 | "드디어 퇴근 시간이에요~" |
| 신년 | 1/1 | 파티햇 + 폭죽 | "새해 첫 날! 올해도 잘 부탁해요!" |
| 크리스마스 | 12/24 ~ 12/25 | 산타모자 | "메리 크리스마스~ 공장도 쉬는 날!" |
| 비 오는 날 | 날씨 API 또는 수동 트리거 | 우산 소품 | "오늘 비 온대요. 우산 챙기세요!" |

**구현 방식:**
- 기간 판단: 클라이언트 측 Date 객체 기반 (서버 의존 없음)
- 음력 계산: `korean-lunar-calendar` 라이브러리 또는 하드코딩 (3년치 날짜 테이블)
- SVG 소품: 기존 KimchiSvg에 `eventOverlay` prop 추가 — 외형은 CSS transform/opacity

#### 2.3 사용자 스토리

**UC-03**: 공장 직원으로서, 김장철에 김치군도 앞치마를 입고 있는 것을 보고 즐겁다. 우리 공장만의 특별함을 느낀다.

**UC-04**: 한국 명절에 김치군이 "새해 복 많이 받으세요"라고 먼저 말을 걸어주어 따뜻함을 느낀다.

#### 2.4 비즈니스 가치

- 브랜드 개성 강화 (계절감 있는 AI)
- 명절/이벤트 시 자연스러운 재방문 유도
- "오늘 김치군 어떻게 생겼어?" — 직원들 간 대화 유발 (입소문 효과)

#### 2.5 구현 복잡도

**Medium** — SVG 소품 오버레이 (CSS/SVG), 날짜 판단 로직, 이벤트 대사 풀 추가

#### 2.6 우선순위

**P2** — 감정적 가치 높으나 핵심 기능은 아님

---

### Feature 3: 인터랙션 시스템 (Click Interaction System)

#### 2.1 개요

마스코트를 클릭/탭하면 반응하는 상호작용 레이어. 단방향 정보 전달에서 **쌍방향 상호작용**으로 격상한다.

#### 2.2 인터랙션 유형

| 트리거 | 반응 | 쿨다운 |
|--------|------|--------|
| 캐릭터 클릭 (1번) | 무작위 idle 대사 + 작은 점프 모션 | 2초 |
| 캐릭터 클릭 (3번 빠르게) | "자꾸 건드리지 마세요~!" 대사 + 토라짐 표정 | 10초 |
| 캐릭터 클릭 (5번 빠르게) | error 상태 → "어지러워요..." | 15초 |
| 말풍선 클릭 | 현재 상태의 다른 대사로 교체 | 1초 |
| 말풍선 길게 누르기 | 대사 복사 (클립보드) + "복사했어요!" | 3초 |
| 드래그 | 마스코트 위치 변경 + "어디 데려가요?" 대사 | 즉시 |
| 마우스 호버 | 눈이 커짐 (CSS transition) + 부드러운 흔들림 | - |

#### 2.3 클릭 카운터 로직

```
연속 클릭 감지: 2초 내 클릭은 연속으로 카운트
클릭 카운터: 0 → 리셋 (5초 무입력)
반응 우선순위: 5번 > 3번 > 1번
```

#### 2.4 사용자 스토리

**UC-05**: 처음 사용하는 직원으로서, 김치군을 클릭해보고 반응하는 것을 보며 "이거 살아있네?"라는 첫인상을 받고 싶다.

**UC-06**: 오래 사용한 직원으로서, 김치군을 여러 번 클릭했을 때 토라지는 모습을 보고 웃음이 나온다. 동료들에게 보여주고 싶다.

#### 2.5 비즈니스 가치

- 첫 사용자 전환율(Onboarding Conversion) 향상 — 상호작용이 있으면 탐색 시간 증가
- 입소문 효과 ("클릭하면 반응해!") — 비용 없는 바이럴 마케팅
- 직원 스트레스 해소 기능 (귀여운 반응으로 소소한 즐거움)

#### 2.6 구현 복잡도

**Low~Medium** — 클릭 이벤트 핸들러, 쿨다운 타이머, 드래그 제스처 (Framer Motion 활용)

#### 2.7 우선순위

**P1** — 빠른 개발, 높은 사용자 즐거움 효과

---

### Feature 4: 공장 공정 연동 (Process Integration)

#### 2.1 개요

실제 공장 센서 데이터(발효 온도, 품질 등급 등)에 따라 김치군이 감정적으로 반응한다. AI 어시스턴트와 공장 현장을 감정적으로 연결하는 핵심 기능.

#### 2.2 공정 연동 시나리오

| 공정 이벤트 | 김치군 반응 | 대사 예시 |
|-----------|----------|---------|
| 발효 온도 정상 (4~8°C) | idle → 살짝 행복한 눈 | "온도 딱 좋아요!" |
| 발효 온도 이상 (임계값 초과) | 새 감정 상태: `worried` (걱정) | "온도가 이상해요! 빨리 확인해 주세요!" |
| 품질 A등급 판정 | celebrating → 자랑 대사 | "우리 김치 A등급! 역시 최고야!" |
| 품질 D등급 판정 | error → 위로 대사 | "이번엔 아쉬웠지만 다음엔 더 잘 할 수 있어요!" |
| ML 예측 정확도 높음 (>90%) | success → 자신감 | "제 예측이 맞았어요! 꽤 똑똑하죠?" |
| 문서 검색 결과 없음 | searching → 당황 | "이건 제 책에 없는 내용인데요..." |
| 연속 오류 3회 | error → 반성 | "자꾸 틀려서 미안해요 ㅠ 더 열심히 할게요" |
| 알림(Alert) 발생 | 새 감정 상태: `alert` (경보) | "긴급 알림이에요! 확인해 주세요!" |

#### 2.3 신규 감정 상태 제안

| 상태 | 이름 | 트리거 | 애니메이션 |
|------|------|--------|---------|
| `worried` | 걱정 | 온도/압력 이상 | 미간 찌푸림 + 좌우 흔들림 (불안감) |
| `proud` | 자랑 | 품질 A등급, ML 정확도 높음 | 가슴 내밀기 + 반짝임 별 파티클 |
| `alert` | 경보 | 시스템 알림, 긴급 이상 | 빨간 테두리 깜빡임 + 급격한 흔들림 |

#### 2.4 연동 아키텍처

```
공정 센서 데이터 (기존 /api/process-data/history)
    ↓
useSensorHistory 훅 (기존) → 임계값 감지 로직 추가
    ↓
dispatchMascotEvent({ state: 'worried' }) (기존 이벤트 시스템 활용)
    ↓
김치군 감정 상태 변화
```

**임계값 설정**: 기존 ML 임계값 API (`/api/ml/predict`) 데이터 재활용

#### 2.5 사용자 스토리

**UC-07**: 공장 작업자로서, 발효 온도가 이상해질 때 김치군이 걱정스러운 표정으로 알려주면 대시보드보다 먼저 알아채고 빠르게 대응할 수 있다.

**UC-08**: 품질 관리자로서, A등급 판정 시 김치군이 자랑스러워하는 모습을 보며 팀 성과를 감정적으로 체감하고 팀원들과 공유하고 싶다.

#### 2.6 비즈니스 가치

- 이상 감지 응답 시간 단축 — 감정적 시각 신호는 텍스트 알림보다 즉각적 반응 유발
- 품질 성과에 대한 감정적 보상 → 직원 동기 부여
- AI와 공장 현장의 심리적 연결 강화

#### 2.7 구현 복잡도

**Medium** — 신규 감정 상태 3종 추가 (SVG, CSS, 대사), 임계값 감지 로직, 기존 이벤트 시스템 확장

#### 2.8 우선순위

**P1** — 공장 실용성과 감성의 교차점, 차별화 포인트

---

### Feature 5: 음성 효과음 시스템 (Sound Effects)

#### 2.1 개요

Web Audio API를 활용한 선택적 효과음. 브라우저 합성음으로 외부 파일 의존 없이 구현. 사용자가 개별 ON/OFF 가능.

#### 2.2 효과음 목록

| 트리거 | 효과음 | 느낌 | Web Audio 합성 방법 |
|--------|--------|------|-------------------|
| 채팅 전송 | "삐익~" | 귀엽고 경쾌 | 440Hz→880Hz 피치 슬라이드 (50ms) |
| AI 응답 완료 | "딩동~" | 성취감 | 523Hz + 659Hz 화음 (200ms) |
| 문서 업로드 성공 | "야호~" (3음) | 축하 | C-E-G 아르페지오 (300ms) |
| 레벨업 | "뚜뚜뚜뚝!" | 특별한 성취 | 상승 4음 (500ms) + 짧은 리버브 |
| 오류 발생 | "뚝" | 주의 | 261Hz→196Hz 하강 (100ms) |
| 마스코트 클릭 | "뽁" | 귀여움 | 짧은 버블 음 (30ms) |
| 성취 배지 획득 | "찰캉~" | 특별함 | 금속 타격음 합성 (400ms) |

#### 2.3 구현 방식

```typescript
// Web Audio API 합성 예시 (외부 파일 없음)
const playSound = (type: SoundType) => {
  const ctx = new AudioContext();
  const oscillator = ctx.createOscillator();
  const gain = ctx.createGain();
  // 각 타입별 파라미터 설정
};
```

**선택적 활성화**: MascotSettings에 `soundEnabled: boolean` 추가, LocalStorage 저장

**접근성**: 소리 없이도 완전한 시각적 피드백 유지 (소리는 보완적 피드백)

#### 2.4 사용자 스토리

**UC-09**: 공장 직원으로서, 김치군이 소리를 내면 더 생동감 있게 느껴진다. 단, 회의 중에는 음소거하고 싶다.

**UC-10**: 청각 장애가 있는 직원으로서, 소리가 없어도 모든 기능이 동일하게 작동하는 것이 중요하다.

#### 2.5 비즈니스 가치

- 감각적 피드백으로 작업 완료감 증가 → 생산성 향상 심리 효과
- 소리 기반 알림으로 화면을 보지 않아도 이벤트 인식 가능 (공장 현장 특성 반영)
- WCAG 1.4.2 준수 (소리는 보완적, 끌 수 있음)

#### 2.6 구현 복잡도

**Low** — Web Audio API 합성 (외부 파일 없음), MascotSettings 확장

#### 2.7 우선순위

**P2** — 즐거움 향상, 빠른 구현 가능, 단 선택적이어야 함

---

### Feature 6: 야간 모드 강화 (Enhanced Night Mode)

#### 2.1 개요

현재 22~06시 sleeping 상태를 대폭 강화. 시간대별로 다른 수면 단계를 표현하고, 야근하는 직원을 위한 특별 격려 메시지를 제공한다.

#### 2.2 강화된 야간 시나리오

| 시간대 | 상태 | 특별 표현 | 대사 분위기 |
|--------|------|---------|-----------|
| 22:00 ~ 23:00 | 졸음 시작 | 한쪽 눈 감김 + 하품 모션 | "슬슬 졸려요~ 하품~" |
| 23:00 ~ 02:00 | 깊은 수면 | Zzz 강하게 표시 + 느린 숨쉬기 | "완전 골아떨어졌어요~" |
| 02:00 ~ 04:00 | 새벽 피크 | 깜빡임 눈 + 흐릿한 외형 | "야근이세요? 대단해요 진짜..." |
| 04:00 ~ 06:00 | 기상 준비 | 기지개 모션 + 눈 비비기 | "거의 다 왔어요! 조금만 더!" |

**야간 격려 시스템**: 야간 중 채팅 전송 시 랜덤으로 특별 야근 격려 대사 삽입 (일반 응답에 덧붙임)

**야근 연속 감지**: 이전 날도 22시 이후 활동 기록이 있으면 "또 야근이에요? 건강 챙기세요!" 특별 메시지

#### 2.3 수면 애니메이션 강화

```css
/* 하품 모션 (22~23시) */
@keyframes yawn {
  0%, 80%, 100% { transform: scaleY(1); }
  85% { transform: scaleY(0.85) translateY(3px); } /* 눈 반쯤 감김 */
}

/* 깊은 수면 숨쉬기 */
@keyframes deep-sleep-breathe {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.04); } /* 2초 주기, 느린 호흡 */
}

/* 기지개 (04~06시) */
@keyframes stretch {
  0% { transform: rotate(0deg); }
  25% { transform: rotate(-10deg) scaleX(1.05); }
  75% { transform: rotate(10deg) scaleX(1.05); }
  100% { transform: rotate(0deg); }
}
```

#### 2.4 사용자 스토리

**UC-11**: 야근하는 공장 직원으로서, 김치군이 "새벽 3시에도 일하세요? 진짜 대단해요"라고 말해주면 외로움이 줄어들고 힘이 난다.

**UC-12**: 관리자로서, 야근 패턴이 지속되는 사용자에게 김치군이 은근히 건강 챙기라는 메시지를 전달해 직원 복지를 간접 지원한다.

#### 2.5 비즈니스 가치

- 야간 근무자 사기 증진 — 무형 복지 효과
- 야근 데이터 수집 기회 (익명 집계로 인력 계획에 활용 가능)
- 24시간 공장 운영 환경에서의 AI 활용 확대

#### 2.6 구현 복잡도

**Low~Medium** — CSS 애니메이션 3종 추가, 시간대별 분기 로직, 야근 연속 감지 (LocalStorage)

#### 2.7 우선순위

**P2** — 공장 야간 근무 문화를 고려한 배려 기능

---

### Feature 7: 성취 배지 시스템 (Achievement Badge System)

#### 2.1 개요

사용 마일스톤을 달성할 때 배지를 수여하고 영구 보관한다. 레벨업 시스템의 보완재로, 더 다양한 성취감 포인트를 제공한다.

#### 2.2 배지 목록

| 배지 | 이름 | 달성 조건 | 희귀도 | 대사 |
|------|------|---------|--------|------|
| 🌱 | 첫걸음 | 첫 채팅 메시지 전송 | Common | "첫 질문이에요! 반가워요!" |
| 📄 | 문서 기부자 | 첫 문서 업로드 성공 | Common | "저한테 공부시켜 주셔서 감사해요!" |
| 🎯 | 백발백중 | 채팅 100회 달성 | Rare | "우리 100번이나 대화했어요!" |
| 🔥 | 7일 연속 | 7일 연속 접속 | Rare | "7일 동안 빠짐없이 오셨네요!" |
| 📚 | 지식 탐구자 | 문서 10개 업로드 | Rare | "이제 제 지식이 엄청 늘었어요!" |
| 🌙 | 야근 용사 | 야간(22~06시) 10회 사용 | Rare | "야근을 이겨낸 용사예요!" |
| ⚡ | 속전속결 | 30초 이내 대화 10회 | Uncommon | "빠른 결단력! 멋져요!" |
| 🏆 | 김치 마스터 | 레벨 4 달성 (500회+) | Legendary | "진정한 김치공장의 파트너!" |
| 🤝 | 오래된 친구 | 30일 연속 접속 | Legendary | "한 달 동안 함께해 주셔서 감사해요!" |
| 🎭 | 감정 탐구자 | 7가지 감정 상태 모두 목격 | Uncommon | "제 모든 표정을 봤군요!" |

#### 2.3 배지 UI

- 배지 아이콘: 김치군 하단 소형 배지 스택 표시 (최대 5개)
- 획득 시 팝업: 화면 중앙에 배지 카드 표시 (3초), 효과음 연동
- 배지 컬렉션: 마스코트 클릭 시 배지 갤러리 패널 오픈 (또는 별도 탭)
- LocalStorage 저장: 브라우저별 보관 (Phase 6 이후 서버 동기화)

#### 2.4 희귀도 시각화

| 희귀도 | 배경색 | 테두리 |
|--------|--------|--------|
| Common | #E8E8E8 | 회색 |
| Uncommon | #C6EFCE | 초록 |
| Rare | #BDD7EE | 파란 |
| Legendary | #FFD700 | 금색 글로우 |

#### 2.5 사용자 스토리

**UC-13**: 공장 직원으로서, 첫 문서를 업로드하고 나서 배지를 받으면 "내가 AI를 제대로 사용하고 있구나"라는 확신이 생긴다.

**UC-14**: 30일 연속 접속 배지를 받은 직원으로서, 동료에게 자랑하고 싶다. 공장 내 자연스러운 AI 홍보가 된다.

#### 2.6 비즈니스 가치

- 습관 형성 루프 강화 (Habit Loop: Cue → Routine → Reward)
- 문서 업로드 유도 → RAG 데이터 품질 향상
- 연속 접속 배지 → 일일 활성 사용자 증가
- 직원들 간 배지 자랑 → 자연스러운 사용 문화 형성

#### 2.7 구현 복잡도

**Medium** — 배지 스토어 (LocalStorage), 조건 감지 로직, 배지 UI 컴포넌트, 팝업 애니메이션

#### 2.8 우선순위

**P1** — 레벨업 시스템과 시너지, 사용자 참여도 직결

---

## 3. Priority Matrix

| 기능 | 우선순위 | 복잡도 | 임팩트 | 구현 순서 |
|------|--------|--------|--------|---------|
| F3: 인터랙션 시스템 | **P1** | Low | High | 1순위 |
| F4: 공장 공정 연동 | **P1** | Medium | High | 2순위 |
| F7: 성취 배지 시스템 | **P1** | Medium | High | 3순위 |
| F1: 레벨업 시스템 | **P1** | High | Very High | 4순위 |
| F5: 음성 효과음 | **P2** | Low | Medium | 5순위 |
| F6: 야간 모드 강화 | **P2** | Low~Med | Medium | 6순위 |
| F2: 계절/이벤트 모드 | **P2** | Medium | High | 7순위 |

**P0**: 없음 (모든 기능이 선택적 향상)
**P3**: 없음 (모든 기능이 구현 가치 충분)

---

## 4. Sprint Plan

### Sprint A (Week 1): 즉각적 기쁨 (Quick Wins)

**목표**: 빠른 개발로 즉각적인 사용자 경험 향상

| 작업 | 기능 | 예상 시간 |
|------|------|---------|
| 캐릭터/말풍선 클릭 반응 | F3 | 0.5일 |
| 드래그 이동 기능 | F3 | 0.5일 |
| Web Audio 효과음 5종 | F5 | 0.5일 |
| 야간 시간대별 분기 강화 | F6 | 0.5일 |

### Sprint B (Week 2): 공장 연동 (Factory Integration)

**목표**: 공장 공정 데이터와 감정 연결

| 작업 | 기능 | 예상 시간 |
|------|------|---------|
| `worried` / `proud` / `alert` 감정 상태 추가 | F4 | 1일 |
| 임계값 감지 → 마스코트 이벤트 연동 | F4 | 0.5일 |
| 공정 연동 대사 20개 추가 | F4 | 0.5일 |

### Sprint C (Week 3): 성취와 성장 (Achievement & Growth)

**목표**: 게임화 요소로 참여도 증가

| 작업 | 기능 | 예상 시간 |
|------|------|---------|
| 배지 스토어 + 조건 감지 로직 | F7 | 1일 |
| 배지 UI 컴포넌트 + 팝업 | F7 | 0.5일 |
| 사용 횟수 카운팅 + 레벨 계산 | F1 | 0.5일 |

### Sprint D (Week 4): 레벨업 & 계절 (Level & Seasonal)

**목표**: 깊이 있는 게임화 완성

| 작업 | 기능 | 예상 시간 |
|------|------|---------|
| 레벨별 SVG 변형 (4세트) | F1 | 1일 |
| 레벨업 연출 애니메이션 | F1 | 0.5일 |
| 계절/이벤트 모드 날짜 판단 + 오버레이 | F2 | 1일 |

---

## 5. Technical Architecture

### 5.1 신규 파일 목록

```
components/mascot/
  KimchiSvg.tsx            # 기존 — level prop, eventOverlay prop 추가
  MascotBadgePanel.tsx     # 신규 — 배지 갤러리 UI
  MascotBadgePopup.tsx     # 신규 — 배지 획득 팝업
  MascotLevelBadge.tsx     # 신규 — 레벨 표시 배지

hooks/
  useMascotLevel.ts        # 신규 — 레벨/경험치 관리
  useMascotBadge.ts        # 신규 — 배지 조건 감지 + 획득 처리
  useMascotSound.ts        # 신규 — Web Audio API 효과음
  useMascotInteraction.ts  # 신규 — 클릭/드래그 인터랙션

lib/mascot/
  level-config.ts          # 신규 — 레벨 임계값, 성장 단계 설정
  badge-config.ts          # 신규 — 배지 목록, 조건, 희귀도
  sound-config.ts          # 신규 — 효과음 파라미터
  seasonal-config.ts       # 신규 — 계절/이벤트 날짜 테이블

types/mascot.ts            # 기존 확장 — MascotLevel, Badge, SoundType
```

### 5.2 데이터 스키마 (LocalStorage)

```typescript
// kimchi-mascot-level
interface MascotLevelData {
  level: 1 | 2 | 3 | 4;
  totalInteractions: number;  // 채팅 전송 + 문서 업로드 * 3
  dailyLoginBonus: string;    // YYYY-MM-DD, 마지막 보너스 날짜
}

// kimchi-mascot-badges
interface MascotBadgeData {
  earned: string[];           // 획득한 배지 ID 목록
  earnedDates: Record<string, string>; // badgeId -> YYYY-MM-DD
}

// kimchi-mascot-settings (기존 확장)
interface MascotSettings {
  enabled: boolean;
  speechEnabled: boolean;
  soundEnabled: boolean;      // 신규
  interactionEnabled: boolean; // 신규
}

// kimchi-mascot-night-streak
interface NightStreakData {
  count: number;              // 야간 사용 횟수
  lastNightDate: string;      // 마지막 야간 사용 날짜
  consecutiveDays: number;    // 야근 연속 일수
}
```

### 5.3 이벤트 시스템 확장

기존 `kimchi-mascot` CustomEvent 활용:

```typescript
// 신규 이벤트 타입 추가
dispatchMascotEvent({ state: 'worried', context: 'system', forcedPhrase: '온도 이상!' });
dispatchMascotEvent({ state: 'proud', context: 'system', forcedPhrase: '품질 A등급!' });
dispatchMascotEvent({ state: 'alert', context: 'system' });
```

### 5.4 성능 고려사항

- Web Audio API: 페이지당 단일 `AudioContext` 인스턴스 (전역 싱글톤)
- 레벨업 SVG: 레벨별 SVG를 하나의 컴포넌트에서 조건부 렌더링 (코드 스플리팅 불필요)
- 배지 조건 감지: 이벤트 기반 (폴링 없음), 최소 오버헤드
- 계절 판단: 마운트 시 1회 계산, 자정에 재계산 (setInterval 1회/일)

---

## 6. Non-Functional Requirements

| 요구사항 | 기준 |
|---------|------|
| 성능 | LCP 영향 없음 (코드 스플리팅 유지) |
| 접근성 | 모든 신규 기능 WCAG 2.1 AA 준수 |
| 효과음 | WCAG 1.4.2 — 3초 이상 소리 자동 제어 제공 |
| 배지 | 색상만으로 희귀도 구분하지 않음 (텍스트 병기) |
| 인터랙션 | prefers-reduced-motion 시 클릭 모션 최소화 |
| 저장소 | LocalStorage 5개 키 이내 관리 |
| 번들 사이즈 | 전체 신규 기능 +50KB 이내 |

---

## 7. Risks & Mitigation

| 위험 | 영향 | 확률 | 경감 전략 |
|------|------|------|---------|
| 레벨업 SVG 4세트 작업량 과다 | 일정 지연 | Medium | CSS filter/transform으로 변형 최소화, 핵심 차이점만 구현 |
| Web Audio API 브라우저 호환성 | 일부 환경 소리 미작동 | Low | try-catch 처리, AudioContext resume() 패턴, graceful fallback |
| LocalStorage 용량 초과 | 설정 저장 실패 | Low | 배지 데이터 최대 1KB 이내 설계, try-catch 처리 |
| 공정 연동 데이터 지연 | 감정 반응 부정확 | Medium | 임계값 초과 시 즉시 이벤트, 정상화 시 5초 딜레이 후 idle 복귀 |
| 인터랙션 과도한 클릭 | 사용자 짜증 유발 | Low | 쿨다운 강제 적용, 토라짐 표현으로 유쾌하게 처리 |
| 음력 계산 오류 | 명절 타이밍 어긋남 | Medium | 3년치 하드코딩 날짜 테이블 사용 (음력 라이브러리 의존 최소화) |

---

## 8. Success Criteria

| 지표 | 목표값 |
|------|--------|
| 일일 마스코트 인터랙션 횟수 | 사용자당 평균 3회 이상 |
| 배지 획득률 | 7일 내 첫 배지 획득 사용자 70% 이상 |
| 레벨 2 달성 비율 | 30일 내 활성 사용자 50% 이상 |
| 공장 이상 감지 반응 만족도 | 관리자 설문 4점/5점 이상 |
| 소리 기능 활성화 비율 | 선택 사용자 중 30% 이상 유지 |
| LCP 영향 | +0ms (성능 회귀 없음) |
| 접근성 | Lighthouse Accessibility >= 90 유지 |

---

## 9. Dependencies

| 의존성 | 현황 | 비고 |
|--------|------|------|
| 기존 김치군 마스코트 (c607a07) | 완료 | 7감정 상태, CustomEvent 기반 |
| Framer Motion | 설치됨 | 드래그 제스처에 활용 |
| useSensorHistory 훅 | 구현됨 | F4 공정 연동에 활용 |
| 기존 알림 시스템 | 구현됨 | F4 alert 상태 연동 |
| Web Audio API | 브라우저 기본 | 외부 라이브러리 불필요 |
| korean-lunar-calendar | 선택 설치 | 음력 계산 (또는 하드코딩) |

---

## 10. Appendix

### 10.1 신규 대사 예시

**레벨 2 (배추김치군) 대사:**
- "이제 좀 알 것 같아요. 더 잘 도와드릴게요!"
- "50번이나 대화했어요! 우리 이제 친구죠?"
- "배추에서 이제 진짜 김치가 되어가는 중이에요~"

**레벨 3 (파김치군) 대사:**
- "파김치처럼 몸은 지쳤지만 맛은 최고예요!"
- "이제 웬만한 건 다 알아요. 물어보세요!"
- "200번의 경험이 있어요. 베테랑이 됐어요!"

**레벨 4 (숙성김치군) 대사:**
- "완전히 숙성된 김치군이에요! 최고 맛!"
- "500번의 대화... 우리 이제 인생 동반자네요~"
- "공장의 모든 비밀을 알고 있어요. 맡겨주세요!"

**공장 공정 연동 (worried) 대사:**
- "온도가 이상해요! 빨리 확인해 주세요!"
- "뭔가 잘못되고 있는 것 같아요... 걱정돼요"
- "이러다 김치가 상할 것 같아요!"

**공장 공정 연동 (proud) 대사:**
- "A등급이에요! 우리 김치 최고야!"
- "이번 배치 완벽해요! 자랑스러워요!"
- "품질 검사 통과! 역시 우리 공장이 최고야~"

### 10.2 기술 결정 사항

| 결정 | 이유 |
|------|------|
| Web Audio API 합성음 (파일 없음) | 파일 크기 0KB, CDN 의존 없음, 오프라인 동작 |
| LocalStorage 우선 (서버 없음) | Phase 6 Multi-tenant 이후 서버 동기화 고려 |
| SVG 오버레이 방식 (계절 의상) | 기존 SVG 재사용, 코드 분기 최소화 |
| Framer Motion drag (새 구현 없음) | 기존 의존성 활용, 번들 증가 없음 |
| 음력 하드코딩 (라이브러리 없음) | 3년치 날짜 테이블 ~2KB, 라이브러리 설치 불필요 |

---

## Version History

| Version | Date | Changes | Author |
|---------|------|---------|--------|
| 1.0 | 2026-02-28 | 초기 창의적 기획 문서 작성 — 7개 기능, 14개 사용자 스토리, Sprint A~D 계획 | kimchi-mascot-creative |
